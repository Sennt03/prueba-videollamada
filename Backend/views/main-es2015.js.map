{"version":3,"sources":["./$_lazy_route_resource lazy namespace object","./node_modules/peerjs/dist sync","./src/app/app-routing.module.ts","./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/call.service.ts","./src/app/dialog/callinfo-dialog.component.ts","./src/app/dialog/callinfo-dialog.component.html","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":"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","file":"main-es2015.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"./node_modules/peerjs/dist sync recursive\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\n\nconst routes: Routes = [];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { Component, ElementRef, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Observable, of } from 'rxjs';\nimport { filter, switchMap } from 'rxjs/operators';\nimport { CallService } from './call.service';\nimport { CallInfoDialogComponents, DialogData } from './dialog/callinfo-dialog.component';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent implements OnInit, OnDestroy {\n  public isCallStarted$: Observable<boolean>;\n  private peerId: string;\n\n  @ViewChild('localVideo') localVideo: ElementRef<HTMLVideoElement>;\n  @ViewChild('remoteVideo') remoteVideo: ElementRef<HTMLVideoElement>;\n\n  constructor(public dialog: MatDialog, private callService: CallService) {\n    this.isCallStarted$ = this.callService.isCallStarted$;\n    this.peerId = this.callService.initPeer();\n  }\n  \n  ngOnInit(): void {\n    this.callService.localStream$\n      .pipe(filter(res => !!res))\n      .subscribe(stream => this.localVideo.nativeElement.srcObject = stream)\n    this.callService.remoteStream$\n      .pipe(filter(res => !!res))\n      .subscribe(stream => this.remoteVideo.nativeElement.srcObject = stream)\n  }\n  \n  ngOnDestroy(): void {\n    this.callService.destroyPeer();\n  }\n\n  public showModal(joinCall: boolean): void {\n    let dialogData: DialogData = joinCall ? ({ peerId: null, joinCall: true }) : ({ peerId: this.peerId, joinCall: false });\n    const dialogRef = this.dialog.open(CallInfoDialogComponents, {\n      width: '250px',\n      data: dialogData\n    });\n\n    dialogRef.afterClosed()\n      .pipe(\n        switchMap(peerId => \n          joinCall ? of(this.callService.establishMediaCall(peerId)) : of(this.callService.enableCallAnswer())\n        ),\n      )\n      .subscribe(_  => { });\n  }\n\n  public endCall() {\n    this.callService.closeMediaCall();\n  }\n}\n","<div class=\"container-fluid\">\n  <div class=\"row p-2\">\n    <button mat-raised-button color=\"primary\" class=\"m-2\" [disabled]=\"isCallStarted$ | async\" (click)=\"showModal(false)\">Start Call</button>\n    <button mat-raised-button class=\"m-2\" [disabled]=\"isCallStarted$ | async\" (click)=\"showModal(true)\">Join Call</button>\n    <button mat-raised-button color=\"warn\" class=\"m-2\" [disabled]=\"!(isCallStarted$ | async)\" (click)=\"endCall()\">End Call</button>\n  </div>\n  <div class=\"row\">\n    <div class=\"col text-center\">\n      <div id=\"video-wrapper\">\n        <video #remoteVideo id=\"remote-video\" poster=\"./assets/video-placeholder.jpg\" autoplay playsinline></video>\n        <video #localVideo id=\"local-video\" autoplay playsinline [muted]=true></video>\n      </div>\n    </div>\n  </div>\n</div>","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { MatButtonModule } from '@angular/material/button'\nimport { CallInfoDialogComponents } from './dialog/callinfo-dialog.component';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from \"@angular/material/form-field\"\nimport { MatInputModule } from \"@angular/material/input\"\nimport { FormsModule } from '@angular/forms';\nimport { ClipboardModule } from '@angular/cdk/clipboard';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { CallService } from './call.service';\n\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    CallInfoDialogComponents\n  ],\n  imports: [\n    BrowserModule,\n    AppRoutingModule,\n    FormsModule,\n    BrowserAnimationsModule,\n    MatButtonModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatInputModule,\n    ClipboardModule,\n    MatSnackBarModule\n  ],\n  providers: [\n    CallService\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { Injectable } from '@angular/core';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport Peer from 'peerjs';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { v4 as uuidv4 } from 'uuid';\n\n\n@Injectable()\nexport class CallService {\n\n    private peer: Peer;\n    private mediaCall: Peer.MediaConnection;\n  \n    private localStreamBs: BehaviorSubject<MediaStream> = new BehaviorSubject(null);\n    public localStream$ = this.localStreamBs.asObservable();\n    private remoteStreamBs: BehaviorSubject<MediaStream> = new BehaviorSubject(null);\n    public remoteStream$ = this.remoteStreamBs.asObservable();\n\n    private isCallStartedBs = new Subject<boolean>();\n    public isCallStarted$ = this.isCallStartedBs.asObservable();\n\n    constructor(private snackBar: MatSnackBar) { }\n\n    public initPeer(): string {\n        if (!this.peer || this.peer.disconnected) {\n            const peerJsOptions: Peer.PeerJSOption = {\n                debug: 3,\n                config: {\n                    iceServers: [\n                        {\n                            urls: [\n                                'stun:stun1.l.google.com:19302',\n                                'stun:stun2.l.google.com:19302',\n                            ],\n                        }]\n                }\n            };\n            try {\n                let id = uuidv4();\n                this.peer = new Peer(id, peerJsOptions);\n                return id;\n            } catch (error) {\n                console.error(error);\n            }\n        }\n    }\n\n    public async establishMediaCall(remotePeerId: string) {\n        try {\n            const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n\n            const connection = this.peer.connect(remotePeerId);\n            connection.on('error', err => {\n                console.error(err);\n                this.snackBar.open(err, 'Close');\n            });\n\n            this.mediaCall = this.peer.call(remotePeerId, stream);\n            if (!this.mediaCall) {\n                let errorMessage = 'Unable to connect to remote peer';\n                this.snackBar.open(errorMessage, 'Close');\n                throw new Error(errorMessage);\n            }\n            this.localStreamBs.next(stream);\n            this.isCallStartedBs.next(true);\n\n            this.mediaCall.on('stream',\n                (remoteStream) => {\n                    this.remoteStreamBs.next(remoteStream);\n                });\n            this.mediaCall.on('error', err => {\n                this.snackBar.open(err, 'Close');\n                console.error(err);\n                this.isCallStartedBs.next(false);\n            });\n            this.mediaCall.on('close', () => this.onCallClose());\n        }\n        catch (ex) {\n            console.error(ex);\n            this.snackBar.open(ex, 'Close');\n            this.isCallStartedBs.next(false);\n        }\n    }\n\n    public async enableCallAnswer() {\n        try {\n            const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n            this.localStreamBs.next(stream);\n            this.peer.on('call', async (call) => {\n    \n                this.mediaCall = call;\n                this.isCallStartedBs.next(true);\n    \n                this.mediaCall.answer(stream);\n                this.mediaCall.on('stream', (remoteStream) => {\n                    this.remoteStreamBs.next(remoteStream);\n                });\n                this.mediaCall.on('error', err => {\n                    this.snackBar.open(err, 'Close');\n                    this.isCallStartedBs.next(false);\n                    console.error(err);\n                });\n                this.mediaCall.on('close', () => this.onCallClose());\n            });            \n        }\n        catch (ex) {\n            console.error(ex);\n            this.snackBar.open(ex, 'Close');\n            this.isCallStartedBs.next(false);            \n        }\n    }\n\n    private onCallClose() {\n        this.remoteStreamBs?.value.getTracks().forEach(track => {\n            track.stop();\n        });\n        this.localStreamBs?.value.getTracks().forEach(track => {\n            track.stop();\n        });\n        this.snackBar.open('Call Ended', 'Close');\n    }\n\n    public closeMediaCall() {\n        this.mediaCall?.close();\n        if (!this.mediaCall) {\n            this.onCallClose()\n        }\n        this.isCallStartedBs.next(false);\n    }\n\n    public destroyPeer() {\n        this.mediaCall?.close();\n        this.peer?.disconnect();\n        this.peer?.destroy();\n    }\n\n}","import { Inject } from '@angular/core';\nimport { Component } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA} from '@angular/material/dialog';\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\n@Component({\n    selector: 'app-call-info-dialog',\n    templateUrl: './callinfo-dialog.component.html',\n    styleUrls: ['./callinfo-dialog.component.scss']\n})\nexport class CallInfoDialogComponents {\n    constructor(\n        public dialogRef: MatDialogRef<CallInfoDialogComponents>,\n        @Inject(MAT_DIALOG_DATA) public data: DialogData,\n        private _snackBar: MatSnackBar\n    ) { }\n\n    public showCopiedSnackBar() {        \n        this._snackBar.open('Peer ID Copied!', 'Hurrah', {\n        duration: 1000,\n        horizontalPosition: 'center',\n        verticalPosition: 'top'\n      });\n    }\n}\n\nexport interface DialogData {\n    peerId?: string;\n    joinCall: boolean\n}","<h1 mat-dialog-title>Call Info</h1>\n<div mat-dialog-content>\n  <mat-form-field [cdkCopyToClipboard]=\"data.peerId\" (click)=\"showCopiedSnackBar()\">\n    <mat-label>{{ data.joinCall ? 'INSERT REMOTE ID' : 'CLICK TO COPY YOUR ID' }}</mat-label>\n    <input [disabled]=\"!data.joinCall\" matInput [(ngModel)]=\"data.peerId\">\n  </mat-form-field>\n</div>\n<div mat-dialog-actions>\n  <button mat-raised-button [mat-dialog-close]=\"data.peerId\">Ok</button>\n</div>","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":"webpack:///"}